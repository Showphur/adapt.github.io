<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  <title>Algebra Game â€“ Adapt</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <style>
Â  Â  body { font-family: 'Inter', sans-serif; }

Â  Â  /* Custom Modal Styles (for validation messages) */
Â  Â  .modal-overlay {
Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  background-color: rgba(0, 0, 0, 0.5);
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  z-index: 1000;
Â  Â  Â  Â  visibility: hidden;
Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  transition: visibility 0s, opacity 0.3s ease-in-out;
Â  Â  }
Â  Â  .modal-overlay.active {
Â  Â  Â  Â  visibility: visible;
Â  Â  Â  Â  opacity: 1;
Â  Â  }
Â  Â  .modal-content {
Â  Â  Â  Â  background-color: white;
Â  Â  Â  Â  padding: 2rem;
Â  Â  Â  Â  border-radius: 0.75rem; /* rounded-xl */
Â  Â  Â  Â  box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1); /* shadow-lg */
Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  max-width: 90%;
Â  Â  Â  Â  width: 400px;
Â  Â  Â  Â  transform: translateY(-20px);
Â  Â  Â  Â  transition: transform 0.3s ease-in-out;
Â  Â  }
Â  Â  .modal-overlay.active .modal-content {
Â  Â  Â  Â  transform: translateY(0);
Â  Â  }
Â  </style>
</head>
<body class="bg-white text-gray-900 min-h-screen flex flex-col">
Â  <header class="bg-white py-4 shadow-sm">
Â  Â  <div class="container mx-auto px-4 flex justify-between items-center max-w-6xl">
Â  Â  Â  <a href="../index.html" class="text-3xl font-bold tracking-tight">Adapt</a>
Â  Â  Â  <div class="text-lg font-semibold">ðŸ’° <span id="wallet">$0.00</span></div>
Â  Â  </div>
Â  </header>

Â  <main class="flex-grow container mx-auto px-4 py-12 max-w-xl">
Â  Â  <h1 class="text-4xl font-bold text-center mb-6">Algebra Game</h1>
Â  Â  <p class="text-center text-gray-700 mb-8">Solve the algebra problems below. Earn $1 for each correct answer!</p>

Â  Â  <!-- Removed text-center from #game as elements are now individually centered -->
Â  Â  <div id="game" class="bg-gray-100 p-6 rounded-lg shadow-md">
Â  Â  Â  <p id="explanation" class="mb-4 text-gray-700 italic min-h-[3em] text-center"></p>
Â  Â  Â  <p id="question" class="text-xl font-medium mb-4 text-center"></p>
Â  Â  Â  <input type="text" id="answer" class="border rounded px-3 py-2 w-full mb-4 text-center" placeholder="Type your answer here" />
Â  Â  Â  
        <div class="flex justify-center mb-4"> <!-- New div to center buttons -->
Â  Â  Â        <button id="submitBtn" onclick="checkAnswer()" class="bg-gray-800 text-white px-4 py-2 rounded hover:bg-gray-600">Submit</button>
Â  Â  Â        <button id="nextBtn" onclick="nextQuestion()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-500 ml-2 hidden">OK</button>
        </div>

Â  Â  Â  <p id="feedback" class="mt-4 text-lg min-h-[2em] text-center"></p>
Â  Â  Â  <p class="mt-2 text-gray-600 text-center">Question <span id="progress">1</span> of 20</p>
Â  Â  </div>
Â  </main>

Â  <footer class="bg-gray-900 text-white py-6 text-center text-gray-400">
Â  Â  <p>&copy; <span id="year"></span> Adapt. All rights reserved.</p>
Â  </footer>

Â  Â  <!-- Custom Modal Structure -->
Â  Â  <div id="customModal" class="modal-overlay">
Â  Â  Â  Â  <div class="modal-content">
Â  Â  Â  Â  Â  Â  <p id="modalMessage" class="text-lg font-semibold mb-4"></p>
Â  Â  Â  Â  Â  Â  <button id="modalCloseBtn" class="bg-gray-800 text-white px-6 py-2 rounded-full hover:bg-gray-600 transition-colors">OK</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  <script>
Â  Â  const BALANCE_KEY = 'adapt_wallet_balance';
Â  Â  const walletEl = document.getElementById('wallet');
Â  Â  const yearEl = document.getElementById('year');
Â  Â  const questionEl = document.getElementById('question');
Â  Â  const answerEl = document.getElementById('answer');
Â  Â  const feedbackEl = document.getElementById('feedback');
Â  Â  const explanationEl = document.getElementById('explanation');
Â  Â  const progressEl = document.getElementById('progress');
Â  Â  const submitBtn = document.getElementById('submitBtn');
Â  Â  const nextBtn = document.getElementById('nextBtn');

Â  Â  const customModal = document.getElementById('customModal');
Â  Â  const modalMessage = document.getElementById('modalMessage');
Â  Â  const modalCloseBtn = document.getElementById('modalCloseBtn');

Â  Â  // Function to show the custom modal
Â  Â  function showModal(message) {
Â  Â  Â  Â  modalMessage.textContent = message;
Â  Â  Â  Â  customModal.classList.add('active');
Â  Â  }

Â  Â  // Function to hide the custom modal
Â  Â  function hideModal() {
Â  Â  Â  Â  customModal.classList.remove('active');
Â  Â  }

Â  Â  // Event listener for closing the modal
Â  Â  modalCloseBtn.addEventListener('click', hideModal);

Â  Â  const questions = [
Â  Â  Â  { q: 'x + 3 = 7', a: 4, expl: 'To find x, subtract 3 from 7. So, 7 - 3 = 4.' },
Â  Â  Â  { q: '2x = 10', a: 5, expl: 'Divide both sides by 2 to find x. So, 10 Ã· 2 = 5.' },
Â  Â  Â  { q: 'x - 5 = 2', a: 7, expl: 'Add 5 to both sides to find x. So, 2 + 5 = 7.' },
Â  Â  Â  { q: '3x = 15', a: 5, expl: 'Divide both sides by 3. So, 15 Ã· 3 = 5.' },
Â  Â  Â  { q: 'x / 2 = 4', a: 8, expl: 'Multiply both sides by 2. So, 4 Ã— 2 = 8.' },
Â  Â  Â  { q: 'x + 6 = 10', a: 4, expl: 'Subtract 6 from both sides. So, 10 - 6 = 4.' },
Â  Â  Â  { q: '5x = 25', a: 5, expl: 'Divide both sides by 5. So, 25 Ã· 5 = 5.' },
Â  Â  Â  { q: 'x - 4 = 1', a: 5, expl: 'Add 4 to both sides. So, 1 + 4 = 5.' },
Â  Â  Â  { q: 'x / 3 = 3', a: 9, expl: 'Multiply both sides by 3. So, 3 Ã— 3 = 9.' },
Â  Â  Â  { q: '4x = 16', a: 4, expl: 'Divide both sides by 4. So, 16 Ã· 4 = 4.' },
Â  Â  Â  { q: 'x + 2 = 9', a: 7, expl: 'Subtract 2 from both sides. So, 9 - 2 = 7.' },
Â  Â  Â  { q: 'x - 3 = 0', a: 3, expl: 'Add 3 to both sides. So, 0 + 3 = 3.' },
Â  Â  Â  { q: 'x / 4 = 5', a: 20, expl: 'Multiply both sides by 4. So, 5 Ã— 4 = 20.' },
Â  Â  Â  { q: '6x = 12', a: 2, expl: 'Divide both sides by 6. So, 12 Ã· 6 = 2.' },
Â  Â  Â  { q: 'x + 5 = 12', a: 7, expl: 'Subtract 5 from both sides. So, 12 - 5 = 7.' },
Â  Â  Â  { q: '3x = 21', a: 7, expl: 'Divide both sides by 3. So, 21 Ã· 3 = 7.' },
Â  Â  Â  { q: 'x - 7 = 6', a: 13, expl: 'Add 7 to both sides. So, 6 + 7 = 13.' },
Â  Â  Â  { q: 'x / 5 = 2', a: 10, expl: 'Multiply both sides by 5. So, 2 Ã— 5 = 10.' },
Â  Â  Â  { q: '7x = 28', a: 4, expl: 'Divide both sides by 7. So, 28 Ã· 7 = 4.' },
Â  Â  Â  { q: 'x + 9 = 18', a: 9, expl: 'Subtract 9 from both sides. So, 18 - 9 = 9.' }
Â  Â  ];

Â  Â  // Function to shuffle an array
Â  Â  function shuffleArray(arr) {
Â  Â  Â  for (let i = arr.length - 1; i > 0; i--) {
Â  Â  Â  Â  const j = Math.floor(Math.random() * (i + 1));
Â  Â  Â  Â  [arr[i], arr[j]] = [arr[j], arr[i]];
Â  Â  Â  }
Â  Â  Â  return arr;
Â  Â  }

Â  Â  // Shuffle questions on load to randomize order
Â  Â  let shuffledQuestions = shuffleArray([...questions]);
Â  Â  let currentQuestionIndex = 0;


Â  Â  function getBalance() {
Â  Â  Â  Â  // Attempt to get balance from localStorage. Returns 0 if not found.
Â  Â  Â  return Number(localStorage.getItem(BALANCE_KEY)) || 0;
Â  Â  }

Â  Â  function setBalance(val) {
Â  Â  Â  Â  // Sets balance in localStorage
Â  Â  Â  localStorage.setItem(BALANCE_KEY, val);
Â  Â  Â  Â  // Updates the wallet display in the header
Â  Â  Â  if (walletEl) {
Â  Â  Â  Â  walletEl.textContent = `$${val.toFixed(2)}`;
Â  Â  Â  }
Â  Â  }

Â  Â  // Global function for adding money, callable from other pages/games
Â  Â  // This ensures that addMoney works even if it's called from index.html (the parent frame)
Â  Â  // or if it's called locally within algebra/index.html.
Â  Â  window.addMoney = function(amount) {
Â  Â  Â  Â  // Since both the main page and this game access the same localStorage key,
Â  Â  Â  Â  // we can directly update the balance here.
Â  Â  Â  Â  setBalance(getBalance() + amount);
Â  Â  };

Â  Â  function showQuestion() {
Â  Â  Â  Â  // Clear feedback and explanation immediately when loading a new question
Â  Â  Â  Â  feedbackEl.textContent = '';
Â  Â  Â  Â  explanationEl.textContent = '';
        // Reset feedback styling
        feedbackEl.className = 'mt-4 text-lg min-h-[2em] text-center';

Â  Â  Â  if(currentQuestionIndex >= shuffledQuestions.length) {
Â  Â  Â  Â  feedbackEl.textContent = 'You completed all questions! ðŸŽ‰';
Â  Â  Â  Â  explanationEl.textContent = '';
Â  Â  Â  Â  questionEl.textContent = 'All challenges completed!';
Â  Â  Â  Â  answerEl.style.display = 'none';
Â  Â  Â  Â  submitBtn.style.display = 'none';
Â  Â  Â  Â  nextBtn.style.display = 'none';
Â  Â  Â  Â  progressEl.textContent = shuffledQuestions.length; // Show total questions completed
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  const q = shuffledQuestions[currentQuestionIndex];
Â  Â  Â  questionEl.textContent = `Solve: ${q.q}`;
Â  Â  Â  progressEl.textContent = currentQuestionIndex + 1;
Â  Â  Â  answerEl.value = '';
Â  Â  Â  answerEl.disabled = false;
Â  Â  Â  submitBtn.disabled = false;
Â  Â  Â  nextBtn.style.display = 'none'; // Hide OK button
Â  Â  Â  answerEl.style.display = 'block'; // Ensure input is visible
Â  Â  Â  submitBtn.style.display = 'inline-block'; // Ensure submit is visible
Â  Â  Â  answerEl.focus(); // Focus on the answer input
Â  Â  }

Â  Â  function checkAnswer() {
Â  Â  Â  const userAnswer = Number(answerEl.value);
Â  Â  Â  const currentQ = shuffledQuestions[currentQuestionIndex];
Â  Â  Â  const correctAnswer = currentQ.a;
Â  Â  Â  const explanation = currentQ.expl;

Â  Â  Â  // Input validation using the modal
Â  Â  Â  if (answerEl.value.trim() === '' || isNaN(userAnswer)) {
Â  Â  Â  Â  Â  showModal('Please enter a valid number for your answer.');
Â  Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  answerEl.disabled = true;
Â  Â  Â  submitBtn.disabled = true;

Â  Â  Â  if (userAnswer === correctAnswer) {
Â  Â  Â  Â  window.addMoney(1); // Use global addMoney
Â  Â  Â  Â  feedbackEl.textContent = 'Correct! +$1 earned ðŸŽ‰';
Â  Â  Â  Â  // Make correct message larger and bold
Â  Â  Â  Â  feedbackEl.className = 'mt-4 text-2xl font-bold text-green-600 min-h-[2em] text-center';
Â  Â  Â  Â  explanationEl.textContent = ''; // Clear explanation on correct answer
Â  Â  Â  Â  // Automatically move to next question after correct answer
Â  Â  Â  Â  setTimeout(nextQuestion, 1500); // 1.5 second delay
Â  Â  Â  } else {
Â  Â  Â  Â  feedbackEl.textContent = `Oops! The correct answer was ${correctAnswer}.`;
Â  Â  Â  Â  feedbackEl.className = 'mt-4 text-lg text-red-600 min-h-[2em] text-center';
        // Make explanation larger and centered for incorrect answers
        explanationEl.className = 'mb-4 text-xl text-gray-700 italic min-h-[3em] text-center';
Â  Â  Â  Â  explanationEl.textContent = explanation; // Show explanation on incorrect answer
Â  Â  Â  Â  nextBtn.style.display = 'inline-block'; // Show OK button for manual progression
Â  Â  Â  }
Â  Â  }

Â  Â  function nextQuestion() {
Â  Â  Â  currentQuestionIndex++;
Â  Â  Â  showQuestion(); // Load the next question or completion message
Â  Â  }

Â  Â  yearEl.textContent = new Date().getFullYear();
Â  Â  // Initialize wallet display when the page loads
Â  Â  setBalance(getBalance());
Â  Â  showQuestion(); // Initial question load
Â  </script>
</body>
</html>
